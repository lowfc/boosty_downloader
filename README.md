# Boosty media downloader (windows)

- Приложение скачает весь **_доступный вам_** медиаконтент со страницы автора на boosty.to;

- Приложение предназначено для скачивания **_вашего контента_** с **_вашей страницы boosty_**, 
автор не несет ответственность за нецелевое использование приложения;

- **Это не хак-тул**! Приложение скачает только тот контент, к которому вы имеете доступ на сайте boosty.to.


## Как это работает

Приложение создаст папку с названием, совпадающим с user_name автора на boosty и:

- В случае синхронизации по медиа (storage_type: media):
Скачает все доступные фото, видео и аудио (в раздельные директории). Приложение скачает контент в самом высоком из доступных разрешений. При повторном запуске,
уже скачанный контент будет игнорироваться, а новый добавляться в соответствующие директории.
- В случае синхронизации по постам (storage_type: post):
Создаст папку posts, в которую будет синхронизироваться список постов. Один пост - одна папка. Название папки совпадает с ID поста. 
Внутри папки поста будут созданы директории для фото, видео и аудио и синхронизация в них будет производится аналогично storage_type: media.
Так же в каждой паке поста будет создан файл contents.txt - в него будет записываться текст поста.

Не переименовывайте и не удаляйте файлы и директории, созданные приложением, иначе при следующей синхронизации они будут скачаны снова.


## Установка и запуск

### Конфигурация
- Откройте config.yml 
- Введите корневую директорию для синхронизации в file -> sync_dir
- Если хотите скачать закрытый (но доступный вам) контент, заполните auth -> cookie и auth -> authorization (ниже описана инструкция по получению этих данных)
- Установите необходимый способ синхронизации в content -> storage_type (media или post)
- Если какой-то из типов контента вам не нужен, удалите (или закомментируйте с помощью #) соответствующую строчку в списке content -> collect
- Если лог синхронизации нужно сохранять в файл, заполните блок logging

#### Получение Cookie и Authorization:

Перед тем, как искать Cookie и Authorization не забудьте войти в аккаунт.

##### Вариант 1 (простой)
- Перейдите на вашу страницу на boosty.to
- Нажимте клавишу `F12`
- Перейдите в раздел Console (Консоль)
- В поле ввода консоли введите следующий текст и нажмите Enter:

```
function parseCookie(e,o){const i=`; ${e}`.split(`; ${o}=`);if(2===i.length)return i.pop().split(";").shift()}function parseAuthCookie(e){if(void 0===e)return;let o=e.replaceAll("%7B","{");o=o.replaceAll("%22",'"'),o=o.replaceAll("%3A",":"),o=o.replaceAll("%2C",","),o=o.replaceAll("%7D","}");let i=JSON.parse(o).accessToken;return void 0!==i?"Bearer "+i:void 0}function setUpOutCookie(e){let o=parseCookie(e,"auth"),i=parseAuthCookie(o);return void 0===i?"Authorization data could not be found. Are you sure you're logged in?":`\nCookie:\n\n_clientId=${parseCookie(e,"_clientId")}; _gcl_au=${parseCookie(e,"_gcl_au")}; _ga=${parseCookie(e,"_ga")}; _ym_uid=${parseCookie(e,"_ym_uid")}; _ym_d=${parseCookie(e,"_ym_d")}; _tt_enable_cookie=${parseCookie(e,"_tt_enable_cookie")}; _ttp=${parseCookie(e,"_ttp")}; _ym_isad=${parseCookie(e,"_ym_isad")}; _ym_visorc=${parseCookie(e,"_ym_visorc")}; newUser=${parseCookie(e,"newUser")}; auth=${o}; last_acc=${parseCookie(e,"last_acc")};\n\nAuthorization:\n\n${i}\n  `}const cooks=`; ${document.cookie}`;console.log(setUpOutCookie(cooks));
```
**! При вставке кода в консоль, браузер может показать предупреждение о вставке кода. В таком случае, перед вставкой кода, введите в консоль то, что просит браузер, например: "разрешить вставку", нажмите Enter, а уже потом выполняйте предыдущий шаг.**

- В консоли появится текст вида:

```
Cookie:

<То, что нужно вставить в поле auth -> cookie конфига приложения>

Authorization:

<То, что нужно вставить в поле auth -> authorization конфига приложения>
```

- Вставьте соотетствующий текст в соответствующие поля конфига.
  
##### Вариант 2
- Перейдите на вашу страницу на boosty.to
- Нажимте клавишу `F12`
- Перейдите в раздел Network (Сеть)
- Обновите страницу с помощью `Shift + F5` (важно нажимать именно `Shift + F5`, что бы сбросить кеш браузера, иначе Cookie и Authorization вы не увидите)
- Прокрутите страницу вниз, пока сайт не подгрузит больше постов
- В списке запросов, выберите найдите запрос вида: post/?limit=5&offset=...
- В блоке Request Headers найдите Authorization и Cookie, а затем скопируйте их в соответствующие поля в config.yml 

**Держите содержимое этих параметров в секрете!**

Если через какое-то время приложение перестало скачивать контент, попробуйте обновить значения полей в конфиге, по инструкции выше.


### 1. Запуск сборки (рекомендуется)

- #### Перейдите на [страницу релизов](https://github.com/lowfc/boosty_downloader/releases)
- #### Скачайте последний релиз и распакуйте в удобную для вас папку
- #### Заполните конфиг:
Заполните конфиг по инструкции из блока [Конфигурация](#Конфигурация)
- #### Запустите:
Запустите двойным щелчком, или через терминал. Следуйте инструкциям.

#### Для того, что бы синхронизировать конкретный пост:
1. установите режим синхронизации по постам (storage_type: post);
2. запустите программу с параметром -p <id поста>

Например:

```shell
./boosty_downloader.exe -p e87f6e1b-67ab-4fd0-9633-f8efe4ad1990
```

### 2. Запуск распакованного проекта

Запускайте с python версии 3.10 или выше.

- #### Создайте venv:
```shell
python3 -m venv .\venv
```

- #### Активируйте venv:
```shell
.\venv\Scripts\activate
```

- #### Установите зависимости:
```shell
pip install -r requirements.txt
```

- #### Заполните конфиг:
Заполните конфиг по инструкции из блока [Конфигурация](#Конфигурация)

- #### Запустите и следуйте инструкциям:
```shell
python main.py
```

